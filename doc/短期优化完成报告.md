# äº‹ä»¶ç³»ç»ŸçŸ­æœŸä¼˜åŒ–å®ŒæˆæŠ¥å‘Š

## æ¦‚è¿°

æ ¹æ®ã€Šäº‹ä»¶ç³»ç»Ÿä¼˜åŒ–æ€»ç»“ã€‹ä¸­çš„çŸ­æœŸä¼˜åŒ–è®¡åˆ’ï¼Œæˆ‘ä»¬å·²æˆåŠŸå®Œæˆäº†ä»¥ä¸‹ä¸‰ä¸ªä¸»è¦ä»»åŠ¡ï¼š

1. âœ… **åœ¨ç°æœ‰ç»„ä»¶ä¸­é€æ­¥é‡‡ç”¨æ–°äº‹ä»¶ç³»ç»Ÿ**
2. âœ… **æ·»åŠ æ›´å¤šä¸šåŠ¡ç›¸å…³äº‹ä»¶ç±»å‹**
3. âœ… **å®Œå–„é”™è¯¯ç›‘æ§å’Œä¸ŠæŠ¥æœºåˆ¶**

## å®Œæˆçš„å·¥ä½œ

### 1. äº‹ä»¶ç³»ç»Ÿæ‰©å±•

#### æ–°å¢äº‹ä»¶ç±»å‹
- **åº”ç”¨ç”Ÿå‘½å‘¨æœŸäº‹ä»¶**ï¼š`APP_CRASHED`ã€`APP_INSTALLED`ã€`APP_UNINSTALLED`ã€`APP_UPDATED`
- **ç³»ç»Ÿç›‘æ§äº‹ä»¶**ï¼š`SYSTEM_WARNING`ã€`SYSTEM_PERFORMANCE`
- **ç”¨æˆ·è¡Œä¸ºäº‹ä»¶**ï¼š`USER_PREFERENCE_CHANGED`ã€`USER_PROFILE_UPDATED`
- **é”™è¯¯ç›¸å…³äº‹ä»¶**ï¼š`THEME_ERROR`ã€`NETWORK_ERROR`ã€`NOTIFICATION_ERROR`ã€`KEYBOARD_ERROR`
- **çª—å£ç®¡ç†äº‹ä»¶**ï¼š`WINDOW_CREATED`ã€`WINDOW_DESTROYED`
- **æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶**ï¼š`FILE_CREATED`ã€`FILE_MODIFIED`ã€`FILE_ERROR`
- **å­˜å‚¨ç®¡ç†äº‹ä»¶**ï¼š`STORAGE_QUOTA_WARNING`ã€`STORAGE_QUOTA_EXCEEDED`ã€`STORAGE_CLEARED`
- **å®‰å…¨ç›¸å…³äº‹ä»¶**ï¼š`SECURITY_VIOLATION`ã€`SECURITY_LOGIN_ATTEMPT`ã€`SECURITY_SESSION_EXPIRED`
- **æ€§èƒ½ç›‘æ§äº‹ä»¶**ï¼š`PERFORMANCE_SLOW`ã€`PERFORMANCE_MEMORY_WARNING`ã€`PERFORMANCE_CPU_HIGH`
- **å¼€å‘è°ƒè¯•äº‹ä»¶**ï¼š`DEV_HOT_RELOAD`ã€`DEV_ERROR`ã€`DEV_WARNING`
- **ä¸šåŠ¡åˆ†æäº‹ä»¶**ï¼š`business:feature-used`ã€`business:conversion`ã€`business:engagement`

#### äº‹ä»¶æ•°æ®å¢å¼º
ä¸ºç°æœ‰äº‹ä»¶æ·»åŠ äº†æ›´è¯¦ç»†çš„æ•°æ®å­—æ®µï¼š
- `timestamp`ï¼šæ—¶é—´æˆ³
- `reason`ï¼šåŸå› è¯´æ˜
- `source`ï¼šäº‹ä»¶æº
- `position`ï¼šä½ç½®ä¿¡æ¯
- `previousSize`ï¼šä¹‹å‰çš„å¤§å°
- `stack`ï¼šé”™è¯¯å †æ ˆ
- `severity`ï¼šä¸¥é‡ç¨‹åº¦

### 2. é”™è¯¯ç›‘æ§ç³»ç»Ÿ

#### æ–°å»ºæ–‡ä»¶
- `src/composables/useErrorMonitor.ts` - é”™è¯¯ç›‘æ§ç»„åˆå¼å‡½æ•°

#### åŠŸèƒ½ç‰¹æ€§
- **å¤šç§é”™è¯¯ç±»å‹æ”¯æŒ**ï¼šJavaScripté”™è¯¯ã€Promiseæ‹’ç»ã€èµ„æºåŠ è½½é”™è¯¯ã€ç½‘ç»œé”™è¯¯
- **é”™è¯¯ä¸¥é‡ç¨‹åº¦åˆ†çº§**ï¼šlowã€mediumã€highã€critical
- **è‡ªåŠ¨é”™è¯¯æ•è·**ï¼šå…¨å±€é”™è¯¯ç›‘å¬å™¨
- **æ‰‹åŠ¨é”™è¯¯è®°å½•**ï¼š`captureError`ã€`captureException` æ–¹æ³•
- **é”™è¯¯ç»Ÿè®¡åˆ†æ**ï¼šé”™è¯¯è®¡æ•°ã€åˆ†ç±»ç»Ÿè®¡ã€æœ€è¿‘é”™è¯¯è®°å½•
- **æ€§èƒ½ç›‘æ§é›†æˆ**ï¼šç›‘æ§é¡µé¢æ€§èƒ½æŒ‡æ ‡
- **å¯é…ç½®è¿‡æ»¤**ï¼šæ”¯æŒé”™è¯¯è¿‡æ»¤å’Œè‡ªå®šä¹‰å¤„ç†

### 3. æ€§èƒ½ç›‘æ§ç³»ç»Ÿ

#### æ–°å»ºæ–‡ä»¶
- `src/composables/usePerformanceMonitor.ts` - æ€§èƒ½ç›‘æ§ç»„åˆå¼å‡½æ•°

#### åŠŸèƒ½ç‰¹æ€§
- **å¤šç»´åº¦æ€§èƒ½æŒ‡æ ‡**ï¼š
  - å†…å­˜ä½¿ç”¨æƒ…å†µï¼ˆå·²ç”¨/æ€»é‡/ç™¾åˆ†æ¯”ï¼‰
  - FPSï¼ˆå¸§ç‡ï¼‰ç›‘æ§
  - é¡µé¢åŠ è½½æ—¶é—´
  - DOM èŠ‚ç‚¹æ•°é‡
  - ç½‘ç»œå»¶è¿Ÿ
  - æ¸²æŸ“æ—¶é—´
- **æ™ºèƒ½é˜ˆå€¼ç›‘æ§**ï¼šå¯é…ç½®çš„è­¦å‘Šå’Œä¸¥é‡é˜ˆå€¼
- **æ€§èƒ½è¯„åˆ†ç³»ç»Ÿ**ï¼š0-100åˆ†çš„ç»¼åˆæ€§èƒ½è¯„åˆ†
- **å†å²æ•°æ®è¿½è¸ª**ï¼šæ€§èƒ½æŒ‡æ ‡å†å²è®°å½•å’Œå¹³å‡å€¼è®¡ç®—
- **è‡ªåŠ¨é—®é¢˜ä¸ŠæŠ¥**ï¼šè¶…è¿‡é˜ˆå€¼æ—¶è‡ªåŠ¨è§¦å‘äº‹ä»¶
- **å®æ—¶ç›‘æ§**ï¼šå¯é…ç½®çš„ç›‘æ§é—´éš”

### 4. æ ¸å¿ƒç³»ç»Ÿé›†æˆ

#### useCore å‡½æ•°å¢å¼º
- é›†æˆé”™è¯¯ç›‘æ§ï¼š`enableErrorMonitoring` é€‰é¡¹
- é›†æˆæ€§èƒ½ç›‘æ§ï¼š`enablePerformanceMonitoring` é€‰é¡¹
- ç»Ÿä¸€é…ç½®ç®¡ç†ï¼šé€šè¿‡ `performanceConfig` è‡ªå®šä¹‰æ€§èƒ½ç›‘æ§é…ç½®

### 5. ç»„ä»¶è¿ç§»å’Œä¼˜åŒ–

#### MacOS.vue ä¸»ç»„ä»¶
- è¿ç§»åˆ° `useCore` ç»Ÿä¸€ç®¡ç†
- å¯ç”¨é”™è¯¯ç›‘æ§åŠŸèƒ½
- å¢åŠ æ–°äº‹ä»¶ç±»å‹çš„ç›‘å¬å’Œå¤„ç†
- æ·»åŠ é”™è¯¯æ•è·å’Œä¸šåŠ¡äº‹ä»¶è§¦å‘

#### ComposablesTest.vue æµ‹è¯•ç»„ä»¶
- å®Œå…¨è¿ç§»åˆ°æ–°äº‹ä»¶ç³»ç»Ÿ
- æ·»åŠ é”™è¯¯ç›‘æ§æµ‹è¯•åŠŸèƒ½
- æ·»åŠ æ€§èƒ½ç›‘æ§æµ‹è¯•åŠŸèƒ½
- æ–°å¢ä¸šåŠ¡äº‹ä»¶å’Œé”™è¯¯äº‹ä»¶æµ‹è¯•
- å¢å¼ºUIç•Œé¢ï¼Œæ·»åŠ å½©è‰²æŒ‰é’®å’ŒçŠ¶æ€æ˜¾ç¤º

## æŠ€æœ¯å®ç°äº®ç‚¹

### 1. ç±»å‹å®‰å…¨å¢å¼º
```typescript
// æ‰©å±•çš„äº‹ä»¶æ•°æ®æ˜ å°„
interface EventDataMap {
  [EVENTS.APP_OPENED]: {
    appKey: string
    pid: number
    timestamp?: number
    reason?: string
  }
  // ... æ›´å¤šç±»å‹å®šä¹‰
}
```

### 2. é”™è¯¯ç›‘æ§é›†æˆ
```typescript
// è‡ªåŠ¨é”™è¯¯æ•è·
window.addEventListener('error', (event) => {
  captureError(event.message, {
    filename: event.filename,
    lineno: event.lineno,
    colno: event.colno
  })
})
```

### 3. æ€§èƒ½ç›‘æ§ç®—æ³•
```typescript
// æ€§èƒ½è¯„åˆ†è®¡ç®—
function calculatePerformanceScore(metrics, thresholds): number {
  let score = 100
  // å†…å­˜ä½¿ç”¨è¯„åˆ† (æƒé‡: 25%)
  // FPS è¯„åˆ† (æƒé‡: 30%)
  // DOM èŠ‚ç‚¹è¯„åˆ† (æƒé‡: 20%)
  // ç½‘ç»œå»¶è¿Ÿè¯„åˆ† (æƒé‡: 25%)
  return Math.max(0, Math.min(100, score))
}
```

### 4. ç»Ÿä¸€é…ç½®ç®¡ç†
```typescript
const core = useCore({
  namespace: 'app',
  enableErrorMonitoring: true,
  enablePerformanceMonitoring: true,
  performanceConfig: {
    interval: 3000,
    thresholds: { /* è‡ªå®šä¹‰é˜ˆå€¼ */ }
  }
})
```

## æµ‹è¯•è¦†ç›–

### é”™è¯¯ç›‘æ§æµ‹è¯•
- âœ… æ‰‹åŠ¨é”™è¯¯è®°å½•
- âœ… å¼‚å¸¸æ•è·æµ‹è¯•
- âœ… ç½‘ç»œé”™è¯¯æ¨¡æ‹Ÿ
- âœ… é”™è¯¯ç»Ÿè®¡æ˜¾ç¤º
- âœ… æœ€è¿‘é”™è¯¯æŸ¥çœ‹

### æ€§èƒ½ç›‘æ§æµ‹è¯•
- âœ… æ€§èƒ½æŒ‡æ ‡æ˜¾ç¤º
- âœ… å¥åº·çŠ¶æ€æ£€æŸ¥
- âœ… æ€§èƒ½æŠ¥å‘Šç”Ÿæˆ
- âœ… æ€§èƒ½é—®é¢˜æ¨¡æ‹Ÿ
- âœ… æ€§èƒ½äº‹ä»¶è§¦å‘

### äº‹ä»¶ç³»ç»Ÿæµ‹è¯•
- âœ… è‡ªå®šä¹‰äº‹ä»¶å‘é€
- âœ… å…¨å±€äº‹ä»¶è§¦å‘
- âœ… ä¸šåŠ¡äº‹ä»¶æµ‹è¯•
- âœ… é”™è¯¯äº‹ä»¶æµ‹è¯•

## æ€§èƒ½æŒ‡æ ‡

### ç›‘æ§èƒ½åŠ›
- **å®æ—¶ç›‘æ§**ï¼š3ç§’é—´éš”çš„æ€§èƒ½æ•°æ®æ”¶é›†
- **å†…å­˜ç›‘æ§**ï¼šJavaScript å †å†…å­˜ä½¿ç”¨æƒ…å†µ
- **FPSç›‘æ§**ï¼š60FPSåŸºå‡†çš„å¸§ç‡ç›‘æ§
- **DOMç›‘æ§**ï¼šDOMèŠ‚ç‚¹æ•°é‡è¿½è¸ª
- **ç½‘ç»œç›‘æ§**ï¼šç½‘ç»œå»¶è¿Ÿæµ‹é‡

### é˜ˆå€¼é…ç½®
- **å†…å­˜è­¦å‘Š**ï¼š60% ä½¿ç”¨ç‡
- **å†…å­˜ä¸¥é‡**ï¼š80% ä½¿ç”¨ç‡
- **FPSè­¦å‘Š**ï¼š25 FPS
- **FPSä¸¥é‡**ï¼š10 FPS
- **DOMèŠ‚ç‚¹è­¦å‘Š**ï¼š5000 ä¸ª
- **DOMèŠ‚ç‚¹ä¸¥é‡**ï¼š10000 ä¸ª

## å‘åå…¼å®¹æ€§

- âœ… ä¿æŒç°æœ‰APIä¸å˜
- âœ… æ–°åŠŸèƒ½ä¸ºå¯é€‰å¯ç”¨
- âœ… æ¸è¿›å¼è¿ç§»æ”¯æŒ
- âœ… æ—§ç‰ˆæœ¬äº‹ä»¶ç³»ç»Ÿç»§ç»­å¯ç”¨

## æ–‡ä»¶ç»“æ„

### æ–°å¢æ–‡ä»¶
```
src/composables/
â”œâ”€â”€ useErrorMonitor.ts      # é”™è¯¯ç›‘æ§ç»„åˆå¼å‡½æ•°
â””â”€â”€ usePerformanceMonitor.ts # æ€§èƒ½ç›‘æ§ç»„åˆå¼å‡½æ•°

doc/
â””â”€â”€ çŸ­æœŸä¼˜åŒ–å®ŒæˆæŠ¥å‘Š.md     # æœ¬æŠ¥å‘Šæ–‡ä»¶
```

### ä¿®æ”¹æ–‡ä»¶
```
src/composables/
â”œâ”€â”€ useEventBus.ts          # æ‰©å±•äº‹ä»¶ç±»å‹å’Œæ•°æ®ç»“æ„
â”œâ”€â”€ index.ts                # å¯¼å‡ºæ–°æ¨¡å—å’Œå¢å¼ºuseCore

src/
â”œâ”€â”€ MacOS.vue               # è¿ç§»åˆ°useCoreï¼Œå¯ç”¨ç›‘æ§

src/views/test/
â””â”€â”€ ComposablesTest.vue     # æ·»åŠ ç›‘æ§æµ‹è¯•åŠŸèƒ½
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ä½¿ç”¨
```typescript
// å¯ç”¨å®Œæ•´ç›‘æ§åŠŸèƒ½
const {
  // äº‹ä»¶ç³»ç»Ÿ
  on, off, emit,
  // é”™è¯¯ç›‘æ§
  errorMonitor,
  // æ€§èƒ½ç›‘æ§
  performanceMonitor
} = useCore({
  enableErrorMonitoring: true,
  enablePerformanceMonitoring: true
})
```

### é”™è¯¯ç›‘æ§
```typescript
// æ‰‹åŠ¨è®°å½•é”™è¯¯
captureError('ç”¨æˆ·æ“ä½œå¤±è´¥', {
  component: 'user-form',
  severity: 'medium',
  metadata: { userId: 123 }
})

// æ•è·å¼‚å¸¸
try {
  riskyOperation()
} catch (error) {
  captureException(error, {
    component: 'data-processor',
    severity: 'high'
  })
}
```

### æ€§èƒ½ç›‘æ§
```typescript
// è·å–å½“å‰æ€§èƒ½æŒ‡æ ‡
const metrics = await getCurrentPerformanceMetrics()
console.log('å†…å­˜ä½¿ç”¨:', metrics.memoryUsage.percentage)
console.log('å½“å‰FPS:', metrics.fps)

// æ£€æŸ¥æ€§èƒ½å¥åº·çŠ¶æ€
const health = checkPerformanceHealth()
if (!health.healthy) {
  console.warn('å‘ç°æ€§èƒ½é—®é¢˜:', health.issues)
}
```

### ä¸šåŠ¡äº‹ä»¶
```typescript
// è§¦å‘ä¸šåŠ¡åˆ†æäº‹ä»¶
emit('business:feature-used', {
  feature: 'advanced-search',
  metadata: {
    searchTerms: ['vue', 'typescript'],
    resultCount: 42
  }
})
```

## åç»­è®¡åˆ’

### ä¸­æœŸä¼˜åŒ–ï¼ˆå·²è§„åˆ’ï¼‰
1. äº‹ä»¶ç³»ç»Ÿæ€§èƒ½è¿›ä¸€æ­¥ä¼˜åŒ–
2. æ·»åŠ äº‹ä»¶é‡æ”¾å’Œè°ƒè¯•åŠŸèƒ½
3. å®ç°äº‹ä»¶æŒä¹…åŒ–å­˜å‚¨
4. å¢åŠ æ›´å¤šæ€§èƒ½ç›‘æ§æŒ‡æ ‡

### é•¿æœŸä¼˜åŒ–ï¼ˆå·²è§„åˆ’ï¼‰
1. å¾®å‰ç«¯äº‹ä»¶é€šä¿¡æ”¯æŒ
2. æœåŠ¡ç«¯äº‹ä»¶åŒæ­¥
3. å®æ—¶åä½œåŠŸèƒ½
4. é«˜çº§åˆ†æå’Œå¯è§†åŒ–

## æ€»ç»“

æœ¬æ¬¡çŸ­æœŸä¼˜åŒ–æˆåŠŸå®Œæˆäº†äº‹ä»¶ç³»ç»Ÿçš„ä¸‰ä¸ªæ ¸å¿ƒç›®æ ‡ï¼š

1. **ç³»ç»Ÿè¿ç§»**ï¼šä¸»è¦ç»„ä»¶å·²è¿ç§»åˆ°æ–°äº‹ä»¶ç³»ç»Ÿï¼Œä¿æŒå‘åå…¼å®¹
2. **åŠŸèƒ½æ‰©å±•**ï¼šæ–°å¢30+ä¸šåŠ¡ç›¸å…³äº‹ä»¶ç±»å‹ï¼Œå¢å¼ºæ•°æ®ç»“æ„
3. **ç›‘æ§å®Œå–„**ï¼šå»ºç«‹äº†å®Œæ•´çš„é”™è¯¯ç›‘æ§å’Œæ€§èƒ½ç›‘æ§ä½“ç³»

æ–°ç³»ç»Ÿå…·å¤‡ä»¥ä¸‹ä¼˜åŠ¿ï¼š
- ğŸ”’ **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- ğŸš€ **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–çš„äº‹ä»¶å¤„ç†æœºåˆ¶
- ğŸ” **å¯è§‚æµ‹æ€§**ï¼šå…¨é¢çš„é”™è¯¯å’Œæ€§èƒ½ç›‘æ§
- ğŸ› ï¸ **æ˜“ç”¨æ€§**ï¼šç»Ÿä¸€çš„APIå’Œé…ç½®ç®¡ç†
- ğŸ”„ **å…¼å®¹æ€§**ï¼šå¹³æ»‘çš„è¿ç§»è·¯å¾„

ç³»ç»Ÿç°å·²å‡†å¤‡å¥½æ”¯æŒæ›´å¤æ‚çš„ä¸šåŠ¡åœºæ™¯å’Œå¤§è§„æ¨¡åº”ç”¨éœ€æ±‚ã€‚